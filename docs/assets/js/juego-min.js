(()=>{"use strict";let s=[],e=["C","D","H","S"],t=["J","Q","K","A"],a={puntos:0,cartas:[],valores:[],useAs:!1},n={puntos:0,cartas:[],valores:[],useAs:!1},u=document.querySelector("#btnPedir"),r=document.querySelector("#btnEmpezar"),o=document.querySelector("#btnDetener"),c=document.querySelector("#btnNuevo"),p=document.querySelector("#puntosJugador"),l=document.querySelector("#jugador-cartas"),i=document.querySelector("#puntosDealer"),d=document.querySelector("#dealer-cartas");(()=>{for(let t=2;t<=10;t++)for(let a of e)s.push(t+a);for(let a of e)for(let e of t)s.push(e+a);_.shuffle(s)})();let m,h=()=>{if(0===s.length)throw"No quedan más cartas en la baraja";let e=Math.floor(Math.random()*s.length);return s.splice(e,1)[0]},N=s=>{let e=s.substring(0,s.length-1);return isNaN(e)?"A"===e?11:10:Number(e)};u.disabled=!0,o.disabled=!0,r.addEventListener("click",(()=>{let s=h();a.cartas.push(s),a.valores.push(N(s)),a.puntos+=N(s),p.innerText=a.puntos;let e=document.createElement("img");e.src=`assets/cartas/${s}.png`,e.className="carta",l.append(e),setTimeout((()=>{let s=h();"A"===s.substring(0,s.length-1)?a.puntos+N(s)>21?(a.cartas.push(s),a.valores.push(N(s)),a.puntos+=1):(a.cartas.push(s),a.puntos+=11,a.valores.push(N(s))):a.valores.includes(11)&&!a.useAs&&a.puntos+N(s)>21?(a.cartas.push(s),a.valores.push(N(s)),a.puntos+=N(s)-10,a.useAs=!0):(a.cartas.push(s),a.valores.push(N(s)),a.puntos+=N(s)),21===a.puntos?(p.className="blackjack",p.innerText=a.puntos+" - BackJack"):p.innerText=a.puntos;let e=document.createElement("img");e.src=`assets/cartas/${s}.png`,e.className="carta",l.append(e)}),500),setTimeout((()=>{let s=h();n.cartas.push(s),n.valores.push(N(s)),n.puntos+=N(s),i.innerText=n.puntos;let e=document.createElement("img");e.src=`assets/cartas/${s}.png`,e.className="carta",d.append(e),setTimeout((()=>{let s=h();n.cartas.push(s),n.valores.push(N(s)),n.puntos+=N(s),m=s;let e=document.createElement("img");e.src="assets/cartas/red_back.png",e.className="carta",e.id="cartaVuelta",d.append(e),21!=a.puntos&&(u.disabled=!1),o.disabled=!1}),500)}),1e3),r.disabled=!0})),u.addEventListener("click",(()=>{let s=h();"A"===s.substring(0,s.length-1)?a.puntos+N(s)>21?(a.cartas.push(s),a.valores.push(N(s)),a.puntos+=1):(a.cartas.push(s),a.puntos+=11,a.valores.push(N(s))):a.valores.includes(11)&&!a.useAs&&a.puntos+N(s)>21?(a.cartas.push(s),a.valores.push(N(s)),a.puntos+=N(s)-10,a.useAs=!0):(a.cartas.push(s),a.valores.push(N(s)),a.puntos+=N(s)),p.innerText=a.puntos;let e=document.createElement("img");e.src=`assets/cartas/${s}.png`,e.className="carta",l.append(e),21===a.puntos&&(p.className="blackjack",p.innerText=a.puntos+" - BlacJack",u.disabled=!0),a.puntos>21&&(document.querySelector("#cartaVuelta").src=`assets/cartas/${m}.png`,i.className="blackjack",i.innerText=n.puntos+" - GANÓ",p.className="perdio",p.innerText=a.puntos+" - PERDISTE",u.disabled=!0,o.disabled=!0)}));o.addEventListener("click",(()=>(document.querySelector("#cartaVuelta").src=`assets/cartas/${m}.png`,i.innerText=n.puntos,u.disabled=!0,o.disabled=!0,21===n.puntos?(i.className="blackjack",i.innerText=n.puntos+" - GANÓ",p.className="perdio",void(p.innerText=a.puntos+" - PERDISTE")):n.puntos>21?(i.className="perdio",i.innerText=n.puntos+" - PERDIÓ",p.className="blackjack",void(p.innerText=a.puntos+" - GANASTE")):n.puntos>a.puntos&&n.puntos<21?(i.className="blackjack",i.innerText=n.puntos+" - GANÓ",p.className="perdio",void(p.innerText=a.puntos+" - PERDISTE")):void(s=>{do{let e=h();if("A"===e.substring(0,e.length-1)?n.puntos+N(e)>21?(n.cartas.push(e),n.valores.push(N(e)),n.puntos+=1):(n.cartas.push(e),n.valores.push(N(e)),n.puntos+=11):n.valores.includes(11)&&!n.useAs&&n.puntos+N(e)>21?(n.cartas.push(e),n.valores.push(N(e)),n.puntos+=N(e)-10,n.useAs=!0):(n.cartas.push(e),n.valores.push(N(e)),n.puntos+=N(e)),setTimeout((()=>{i.innerText=n.puntos;let s=document.createElement("img");s.src=`assets/cartas/${e}.png`,s.className="carta",d.append(s),n.puntos>21&&(i.className="perdio",i.innerText=n.puntos+" - PERDIÓ",p.className="blackjack",p.innerText=a.puntos+" - GANASTE"),21===n.puntos&&(i.className="blackjack",i.innerText=n.puntos+" - BlacJack",p.className="perdio",p.innerText=a.puntos+" - PERDISTE"),n.puntos>a.puntos&&n.puntos<21&&(i.className="blackjack",i.innerText=n.puntos+" - GANÓ",p.className="perdio",p.innerText=a.puntos+" - PERDISTE"),n.puntos===a.puntos&&n.puntos<21&&(i.className="blackjack",i.innerText=n.puntos+" - GANÓ",p.className="perdio",p.innerText=a.puntos+" - PERDISTE")}),1e3),s>21)break}while(n.puntos<s&&s<=21)})(a.puntos)))),c.addEventListener("click",(()=>location.reload()))})();