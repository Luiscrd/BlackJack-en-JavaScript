(()=>{"use strict";let s=[];const e=["C","D","H","S"],t=["J","Q","K","A"];let a={puntos:0,cartas:[],valores:[],useAs:!1},n={puntos:0,cartas:[],valores:[],useAs:!1};const o=document.querySelector("#btnPedir"),c=document.querySelector("#btnEmpezar"),u=document.querySelector("#btnDetener"),r=document.querySelector("#btnNuevo"),p=document.querySelector("#puntosJugador"),l=document.querySelector("#jugador-cartas"),i=document.querySelector("#puntosDealer"),d=document.querySelector("#dealer-cartas");(()=>{for(let t=2;t<=10;t++)for(let a of e)s.push(t+a);for(let a of e)for(let e of t)s.push(e+a);_.shuffle(s)})();const m=()=>{if(0===s.length)throw"No quedan más cartas en la baraja";const e=Math.floor(Math.random()*s.length);return s.splice(e,1)[0]},h=s=>{let e=s.substring(0,s.length-1);return e=isNaN(e)?"A"===e?11:10:Number(e),e};let N;o.disabled=!0,u.disabled=!0,c.addEventListener("click",(()=>{const s=m();a.cartas.push(s),a.valores.push(h(s)),a.puntos+=h(s),p.innerText=a.puntos;const e=document.createElement("img");e.src=`assets/cartas/${s}.png`,e.className="carta",l.append(e),setTimeout((()=>{const s=m();"A"===s.substring(0,s.length-1)?a.puntos+h(s)>21?(a.cartas.push(s),a.valores.push(h(s)),a.puntos+=1):(a.cartas.push(s),a.puntos+=11,a.valores.push(h(s))):a.valores.includes(11)&&!a.useAs&&a.puntos+h(s)>21?(a.cartas.push(s),a.valores.push(h(s)),a.puntos+=h(s)-10,a.useAs=!0):(a.cartas.push(s),a.valores.push(h(s)),a.puntos+=h(s)),21===a.puntos?(p.className="blackjack",p.innerText=a.puntos+" - BackJack"):p.innerText=a.puntos;const e=document.createElement("img");e.src=`assets/cartas/${s}.png`,e.className="carta",l.append(e)}),500),setTimeout((()=>{const s=m();n.cartas.push(s),n.valores.push(h(s)),n.puntos+=h(s),i.innerText=n.puntos;const e=document.createElement("img");e.src=`assets/cartas/${s}.png`,e.className="carta",d.append(e),setTimeout((()=>{const s=m();n.cartas.push(s),n.valores.push(h(s)),n.puntos+=h(s),N=s;const e=document.createElement("img");e.src="assets/cartas/red_back.png",e.className="carta",e.id="cartaVuelta",d.append(e),21!=a.puntos&&(o.disabled=!1),u.disabled=!1}),500)}),1e3),c.disabled=!0})),o.addEventListener("click",(()=>{const s=m();"A"===s.substring(0,s.length-1)?a.puntos+h(s)>21?(a.cartas.push(s),a.valores.push(h(s)),a.puntos+=1):(a.cartas.push(s),a.puntos+=11,a.valores.push(h(s))):a.valores.includes(11)&&!a.useAs&&a.puntos+h(s)>21?(a.cartas.push(s),a.valores.push(h(s)),a.puntos+=h(s)-10,a.useAs=!0):(a.cartas.push(s),a.valores.push(h(s)),a.puntos+=h(s)),p.innerText=a.puntos;const e=document.createElement("img");if(e.src=`assets/cartas/${s}.png`,e.className="carta",l.append(e),21===a.puntos&&(p.className="blackjack",p.innerText=a.puntos+" - BlacJack",o.disabled=!0),a.puntos>21){document.querySelector("#cartaVuelta").src=`assets/cartas/${N}.png`,i.className="blackjack",i.innerText=n.puntos+" - GANÓ",p.className="perdio",p.innerText=a.puntos+" - PERDISTE",o.disabled=!0,u.disabled=!0}}));u.addEventListener("click",(()=>(document.querySelector("#cartaVuelta").src=`assets/cartas/${N}.png`,i.innerText=n.puntos,o.disabled=!0,u.disabled=!0,21===n.puntos?(i.className="blackjack",i.innerText=n.puntos+" - GANÓ",p.className="perdio",void(p.innerText=a.puntos+" - PERDISTE")):n.puntos>21?(i.className="perdio",i.innerText=n.puntos+" - PERDIÓ",p.className="blackjack",void(p.innerText=a.puntos+" - GANASTE")):n.puntos>a.puntos&&n.puntos<21?(i.className="blackjack",i.innerText=n.puntos+" - GANÓ",p.className="perdio",void(p.innerText=a.puntos+" - PERDISTE")):void(s=>{do{const e=m();if("A"===e.substring(0,e.length-1)?n.puntos+h(e)>21?(n.cartas.push(e),n.valores.push(h(e)),n.puntos+=1):(n.cartas.push(e),n.valores.push(h(e)),n.puntos+=11):n.valores.includes(11)&&!n.useAs&&n.puntos+h(e)>21?(n.cartas.push(e),n.valores.push(h(e)),n.puntos+=h(e)-10,n.useAs=!0):(n.cartas.push(e),n.valores.push(h(e)),n.puntos+=h(e)),setTimeout((()=>{i.innerText=n.puntos;const s=document.createElement("img");s.src=`assets/cartas/${e}.png`,s.className="carta",d.append(s),n.puntos>21&&(i.className="perdio",i.innerText=n.puntos+" - PERDIÓ",p.className="blackjack",p.innerText=a.puntos+" - GANASTE"),21===n.puntos&&(i.className="blackjack",i.innerText=n.puntos+" - BlacJack",p.className="perdio",p.innerText=a.puntos+" - PERDISTE"),n.puntos>a.puntos&&n.puntos<21&&(i.className="blackjack",i.innerText=n.puntos+" - GANÓ",p.className="perdio",p.innerText=a.puntos+" - PERDISTE"),n.puntos===a.puntos&&n.puntos<21&&(i.className="blackjack",i.innerText=n.puntos+" - GANÓ",p.className="perdio",p.innerText=a.puntos+" - PERDISTE")}),1e3),s>21)break}while(n.puntos<s&&s<=21)})(a.puntos)))),r.addEventListener("click",(()=>location.reload()))})();